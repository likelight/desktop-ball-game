(function(h,d){function m(){if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)){return true}else{return false}}function g(t){var s=document.getElementById("audio");if(s!==null){s.load();s.loop=true;s.play()}}function j(t){var s=document.getElementById("audio");if(s!==null){s.pause()}}document.getElementById("audio-control").addEventListener("click",function(s){if(s.target.className.indexOf("play-stop")>-1){j();s.target.className="play-button"}else{g();s.target.className+=" play-stop"}});function o(v){var t=0;var s=0;s=v%10;t=parseInt(v/10);var u="./images/"+s+".png";document.getElementById("scoreleft-single").setAttribute("src",u)}function l(v){var t=0;var s=0;s=v%10;t=parseInt(v/10);var u="./images/"+s+".png";document.getElementById("scoreright-single").setAttribute("src",u)}function q(x,v,t,s){vx=-x*4;vy=-v*4;var w=0;var u=0;if(vx===0){w=-t*80}else{if(vx>0&&t>0){w=t*80+vx*2.5}else{w=-t*80+vx*2.5}}if(vy===0){u=-s*80}else{u=s*80+vy*2.5}return{vx:w,vy:u}}function k(x,v,t,s){vx=-x*4;vy=-v*4;var w=0;var u=0;if(vx===0){w=-t*80}else{if(vx<0&&t<0){w=t*80+vx*2.5}else{w=-t*80+vx*2.5}}if(vy===0){u=-s*80}else{u=s*80+vy*2.5}return{vx:w,vy:u}}var f=document.getElementById("match");f.width=h.innerWidth;f.height=h.innerHeight-70;var n=f.getBoundingClientRect();var c=1;var a=1;const b=1.2;const e=80;const r=10;const p=90;var i={count:0,leftCount:0,rightCount:0,collisionFlag:false,offsetX:0,offsetY:0,manifest:[{src:"button.png",id:"button"},{src:"court.png",id:"court"},{src:"dice.png",id:"ball"},{src:"win.png",id:"win"},{src:"replay.png",id:"replay"},{src:"shadow.png",id:"shadow"},{src:"ball.mp3",id:"ball_sound"},{src:"win.mp3",id:"win_sound"},],init:function(){this.loader=new d.LoadQueue();this.loader.installPlugin(d.Sound);d.Sound.alternateExtensions=["mp3"];this.loader.addEventListener("complete",this.handleLoadComplete.bind(this));this.loader.loadManifest(this.manifest,true,"./images/");this.leftButtonPosition=[];this.rightButtonPosition=[]},initScore:function(){this.leftScore=0;this.rightScore=0;o(this.leftScore);l(this.rightScore)},setWin:function(s){this.win_sound=d.Sound.play("win_sound",{loop:0});var t=this.loader.getResult("replay");var u=this.loader.getResult("win");this.replayImg=new d.Bitmap(t);this.winImg=new d.Bitmap(u);this.replayImg.scaleX=this.leftButton.scaleX;this.replayImg.scaleY=this.leftButton.scaleY;this.winImg.scaleX=this.leftButton.scaleX/1.5;this.winImg.scaleY=this.leftButton.scaleY/1.5;this.replayImg.y=0.5*n.height-this.replayImg.getTransformedBounds().height;this.replayImg.x=0.5*n.width-this.replayImg.getTransformedBounds().width*0.5;this.drawingCanvas=new d.Shape();this.drawingCanvas.graphics.beginFill("#ffffff").drawRect(0,0,n.width,n.height);this.drawingCanvas.alpha=0.3;if(s==="left"){this.winImg.y=0.5*n.height-this.winImg.getTransformedBounds().height*0.5;this.winImg.rotation=0;this.winImg.x=0.3*n.width-this.winImg.getTransformedBounds().width*0.5}else{if(s==="right"){this.winImg.y=0.5*n.height+this.winImg.getTransformedBounds().height*0.5;this.winImg.rotation=180;this.winImg.x=0.7*n.width+this.winImg.getTransformedBounds().width*0.5}}this.replayImg.addEventListener("click",function(){this.stage.removeChild(this.replayImg);this.stage.removeChild(this.winImg);this.stage.removeChild(this.drawingCanvas);this.win_sound.stop();this.rePlay()}.bind(this));this.stage.addChild(this.winImg);setTimeout(function(){this.stage.addChild(this.drawingCanvas);this.stage.addChild(this.replayImg);this.stage.update()}.bind(this),2500);this.stage.update();d.Ticker.paused=true;this.removeEvent()},tick:function(y){if(y.paused){return}var E=this.checkIsGetScore();if(E){if(E===1){this.rightScore++;if(this.rightScore<=99){l(this.rightScore);if(this.rightScore===5){this.setWin("right");return}}else{this.rightScore=0;l(this.rightScore)}}else{if(E===2){this.leftScore++;if(this.leftScore<=99){o(this.leftScore);if(this.leftScore===5){this.setWin("left");return}}else{this.leftScore=0;o(this.leftScore)}}}this.removeEvent();this.initStart();this.initEvent();this.stage.update();return}var u=20;if(this.leftButtonPosition.length<u){this.leftButtonPosition.push({x:this.leftButton.x,y:this.leftButton.y})}else{this.leftButtonPosition.shift();this.leftButtonPosition.push({x:this.leftButton.x,y:this.leftButton.y})}if(this.rightButtonPosition.length<u){this.rightButtonPosition.push({x:this.rightButton.x,y:this.rightButton.y})}else{this.rightButtonPosition.shift();this.rightButtonPosition.push({x:this.rightButton.x,y:this.rightButton.y})}var D=ndgmr.checkPixelCollision(this.ball,this.leftButton,0);var C=ndgmr.checkPixelCollision(this.ball,this.rightButton,0);if(D&&this.collisionFlag!=="left"){var B=this.leftButtonPosition[0].x-this.leftButtonPosition[this.leftButtonPosition.length-1].x;var t=this.leftButtonPosition[0].y-this.leftButtonPosition[this.leftButtonPosition.length-1].y;
    var v=q(B,t,this.ball.vx,this.ball.vy);this.ball_music=d.Sound.play("ball_sound",{loop:0});this.collisionFlag="left";this.ball.vx=v.vx/80;this.ball.vy=v.vy/80;var w=Math.sqrt(this.ball.vx*this.ball.vx+this.ball.vy*this.ball.vy);if(w<r){this.ball.vx=r*this.ball.vx/w;this.ball.vy=r*this.ball.vx/w}this.ball.isMoving=true;this.count=0;a=c=1}if(C&&this.collisionFlag!=="right"){var s=this.rightButtonPosition[0].x-this.rightButtonPosition[this.rightButtonPosition.length-1].x;var x=this.rightButtonPosition[0].y-this.rightButtonPosition[this.rightButtonPosition.length-1].y;var v=k(s,x,this.ball.vx,this.ball.vy);this.ball_music=d.Sound.play("ball_sound",{loop:0});this.collisionFlag="right";this.ball.vx=v.vx/80;this.ball.vy=v.vy/80;var w=Math.sqrt(this.ball.vx*this.ball.vx+this.ball.vy*this.ball.vy);if(w<r){this.ball.vx=r*this.ball.vx/w;this.ball.vy=r*this.ball.vx/w}this.ball.isMoving=true;this.count=0;a=c=1}if(this.collisionFlag==="left"||this.collisionFlag==="right"){this.count++;if(this.count>=15){this.collisionFlag=false;this.count=0}}this.ball.vCom=Math.sqrt(this.ball.vx*this.ball.vx+this.ball.vy*this.ball.vy);if(this.ball.vCom>=p){this.ball.vCom=p}this.ball.vCom-=b/e;if(Math.abs(this.ball.vCom)<=b/e){this.ball.vCom=0;this.ball.isMoving=false;this.ball.vx=0;this.ball.vy=0;this.stage.update();return}var A=this.ball.vCom*this.ball.vx/Math.sqrt(this.ball.vx*this.ball.vx+this.ball.vy*this.ball.vy);var z=this.ball.vCom*this.ball.vy/Math.sqrt(this.ball.vx*this.ball.vx+this.ball.vy*this.ball.vy);this.ball.vx=A;this.ball.vy=z;if(this.ball.isMoving){this.ball.x+=this.ball.vx*1/2;this.ball.y+=this.ball.vy*1/2;if(this.ball.x<20){if(Math.abs(c*0.8)>10){c=-c*0.8}else{this.ball.vx=-this.ball.vx}}if(this.ball.x>n.width-this.ball.width-15){if(Math.abs(c*0.8)>10){c=-c*0.8}else{this.ball.vx=-this.ball.vx}}if(this.ball.y>n.height-this.ball.height-12){if(Math.abs(a*0.8)>10){a=-a*0.8}else{this.ball.vy=-this.ball.vy}}if(this.ball.y<12){if(Math.abs(a*0.8)>10){a=-a*0.8}else{this.ball.vy=-this.ball.vy}}this.stage.update()}},rePlay:function(){d.Ticker.setPaused(false);this.initStart();this.initScore();this.initEvent()},initStart:function(){this.leftButton.x=0.1*n.width;this.leftButton.y=0.5*n.height-this.leftButton.getTransformedBounds().height*0.5;this.rightButton.x=0.8*n.width;this.rightButton.y=0.5*n.height-this.rightButton.getTransformedBounds().height*0.5;this.offsetX=this.leftButton.getTransformedBounds().width*0.1;this.offsetY=this.rightButton.getTransformedBounds().height*0.25;this.leftShadow.x=0.1*n.width+this.offsetX;this.leftShadow.y=0.5*n.height-this.offsetY;this.rightShadow.x=0.8*n.width+this.offsetX;this.rightShadow.y=0.5*n.height-this.offsetY;this.ball.x=0.5*n.width-0.5*this.ball.width;this.ball.y=0.5*n.height-0.5*this.ball.height;this.ball.isMoving=false;this.ball.vx=0;this.ball.vy=0;this.leftButtonPosition.length=0;this.rightButtonPosition.length=0;c=1;a=1},removeEvent:function(){this.leftButton.removeAllEventListeners();this.rightButton.removeAllEventListeners()},initEvent:function(){this.leftButton.addEventListener("mousedown",function(u){this.lastLeftButtonStyle=this.leftButton.getTransformedBounds();var t=this.leftButton.getTransformedBounds();var v={x:u.stageX,y:u.stageY};var s=this.leftButtonShape=u.target;s.on("pressmove",function(z){s.x=z.stageX-(v.x-t.x);s.y=z.stageY-(v.y-t.y);var y=20;var A=0.5*n.width-t.width;var x=12;var w=n.height-t.height-12;if(s.x<y){s.x=y}if(s.x>A){s.x=A}if(s.y<x){s.y=x}if(s.y>w){s.y=w}this.leftShadow.x=s.x+10;this.leftShadow.y=s.y+this.offsetY;this.stage.update()}.bind(this));s.on("pressup",function(w){}.bind(this))}.bind(this));this.rightButton.addEventListener("mousedown",function(u){var t=this.rightButton.getTransformedBounds();var v={x:u.stageX,y:u.stageY};var s=this.rightButtonShape=u.target;s.on("pressmove",function(z){s.x=z.stageX-(v.x-t.x);s.y=z.stageY-(v.y-t.y);var y=0.5*n.width;var A=n.width-t.width-15;var x=12;var w=n.height-t.height-12;if(s.x<y){s.x=y}if(s.x>A){s.x=A}if(s.y<x){s.y=x}if(s.y>w){s.y=w}this.rightShadow.x=s.x+10;this.rightShadow.y=s.y+this.offsetY;this.stage.update()}.bind(this));s.on("pressup",function(w){}.bind(this))}.bind(this))},initStage:function(){this.stage=new d.Stage(f);d.Touch.enable(this.stage);d.Ticker.setFPS(e);d.Ticker.timingMode=d.Ticker.RAF_SYNCHED;d.Ticker.addEventListener("tick",this.tick.bind(this))},handleLoadComplete:function(){this.initStage();var s=new d.Container();var w=this.loader.getResult("court");var v=new d.Bitmap(w);v.x=v.y=0;var z=(f.width/v.getBounds().width)/1.5;var y=(f.height/(v.getBounds().height))/1.5;v.scaleX=z*1.5;v.scaleY=y*1.5;s.addChild(v);var A=new d.Container();var t=this.loader.getResult("button");var u=this.loader.getResult("shadow");this.leftButton=new d.Bitmap(t);this.rightButton=new d.Bitmap(t);this.leftShadow=new d.Bitmap(u);this.rightShadow=new d.Bitmap(u);this.rightShadow.scaleX=this.leftShadow.scaleX=this.rightButton.scaleX=this.leftButton.scaleX=z;this.rightShadow.scaleY=this.leftShadow.scaleY=this.rightButton.scaleY=this.leftButton.scaleY=y;
    var x=this.loader.getResult("ball");this.ball=new d.Bitmap(x);this.ball.scaleX=z;this.ball.scaleY=y;this.ball.width=this.ball.getTransformedBounds().width;this.ball.height=this.ball.getTransformedBounds().height;this.initScore();this.initStart();this.initEvent();A.addChild(this.ball);A.addChild(this.leftShadow);A.addChild(this.rightShadow);A.addChild(this.rightButton);A.addChild(this.leftButton);this.stage.addChild(s);this.stage.addChild(A);this.stage.update()},checkIsGetScore:function(){var s=n.height;var x=n.width;var u=s*0.32;var w=s*0.64-this.ball.height/2;var t=x*0.048;var v=x*0.92;if(this.ball.x<=t){if(this.ball.y>=u&&this.ball.y<=w){return 1}}if(this.ball.x>=v){if(this.ball.y>=u&&this.ball.y<=w){return 2}}return 0}};h.gameManager=i})(window,createjs);
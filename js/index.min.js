(function(h,f){function k(){if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)){return true}else{return false}}function l(t){var r=0;var q=0;q=t%10;r=parseInt(t/10);var s="./images/"+q+".png";document.getElementById("scoreleft-single").setAttribute("src",s)}function i(t){var r=0;var q=0;q=t%10;r=parseInt(t/10);var s="./images/"+q+".png";document.getElementById("scoreright-single").setAttribute("src",s)}function a(v,t,r,q){vx=-v*4;vy=-t*4;var u=0;var s=0;if(vx===0){u=-r*80}else{if(vx>0&&r>0){u=r*80+vx*2.5}else{u=-r*80+vx*2.5}}if(vy===0){s=-q*80}else{s=q*80+vy*2.5}return{vx:u,vy:s}}function j(v,t,r,q){vx=-v*4;vy=-t*4;var u=0;var s=0;if(vx===0){u=-r*80}else{if(vx<0&&r<0){u=r*80+vx*2.5}else{u=-r*80+vx*2.5}}if(vy===0){s=-q*80}else{s=q*80+vy*2.5}return{vx:u,vy:s}}var d=document.getElementById("match");d.width=h.innerWidth;d.height=h.innerHeight-70;var b=d.getBoundingClientRect();var n=1;var m=1;const p=1.2;const e=80;const g=10;const c=90;var o={count:0,leftCount:0,rightCount:0,collisionFlag:false,offsetX:0,offsetY:0,manifest:[{src:"button.png",id:"button"},{src:"court.png",id:"court"},{src:"dice.png",id:"ball"},{src:"win.png",id:"win"},{src:"replay.png",id:"replay"},{src:"shadow.png",id:"shadow"},{src:"ball.mp3",id:"ball_sound"},{src:"win.mp3",id:"win_sound"},],init:function(){this.loader=new f.LoadQueue();this.loader.installPlugin(f.Sound);f.Sound.alternateExtensions=["mp3"];this.loader.addEventListener("complete",this.handleLoadComplete.bind(this));this.loader.loadManifest(this.manifest,true,"./images/");this.leftButtonPosition=[];this.rightButtonPosition=[];document.getElementById("audio").play()},initScore:function(){this.leftScore=0;this.rightScore=0;l(this.leftScore);i(this.rightScore)},setWin:function(q){this.win_sound=f.Sound.play("win_sound",{loop:0});var r=this.loader.getResult("replay");var s=this.loader.getResult("win");this.replayImg=new f.Bitmap(r);this.winImg=new f.Bitmap(s);this.replayImg.scaleX=this.leftButton.scaleX;this.replayImg.scaleY=this.leftButton.scaleY;this.winImg.scaleX=this.leftButton.scaleX/1.5;this.winImg.scaleY=this.leftButton.scaleY/1.5;this.replayImg.y=0.5*b.height-this.replayImg.getTransformedBounds().height;this.replayImg.x=0.5*b.width-this.replayImg.getTransformedBounds().width*0.5;this.drawingCanvas=new f.Shape();this.drawingCanvas.graphics.beginFill("#ffffff").drawRect(0,0,b.width,b.height);this.drawingCanvas.alpha=0.3;if(q==="left"){this.winImg.y=0.5*b.height-this.winImg.getTransformedBounds().height*0.5;this.winImg.rotation=0;this.winImg.x=0.3*b.width-this.winImg.getTransformedBounds().width*0.5}else{if(q==="right"){this.winImg.y=0.5*b.height+this.winImg.getTransformedBounds().height*0.5;this.winImg.rotation=180;this.winImg.x=0.7*b.width+this.winImg.getTransformedBounds().width*0.5}}this.replayImg.addEventListener("click",function(){this.stage.removeChild(this.replayImg);this.stage.removeChild(this.winImg);this.stage.removeChild(this.drawingCanvas);this.win_sound.stop();this.rePlay()}.bind(this));this.stage.addChild(this.winImg);setTimeout(function(){this.stage.addChild(this.drawingCanvas);this.stage.addChild(this.replayImg);this.stage.update()}.bind(this),2500);this.stage.update();f.Ticker.paused=true;this.removeEvent()},tick:function(w){if(w.paused){return}var C=this.checkIsGetScore();if(C){if(C===1){this.rightScore++;if(this.rightScore<=99){i(this.rightScore);if(this.rightScore===5){this.setWin("right");return}}else{this.rightScore=0;i(this.rightScore)}}else{if(C===2){this.leftScore++;if(this.leftScore<=99){l(this.leftScore);if(this.leftScore===5){this.setWin("left");return}}else{this.leftScore=0;l(this.leftScore)}}}this.removeEvent();this.initStart();this.initEvent();this.stage.update();return}var s=20;if(this.leftButtonPosition.length<s){this.leftButtonPosition.push({x:this.leftButton.x,y:this.leftButton.y})}else{this.leftButtonPosition.shift();this.leftButtonPosition.push({x:this.leftButton.x,y:this.leftButton.y})}if(this.rightButtonPosition.length<s){this.rightButtonPosition.push({x:this.rightButton.x,y:this.rightButton.y})}else{this.rightButtonPosition.shift();this.rightButtonPosition.push({x:this.rightButton.x,y:this.rightButton.y})}var B=ndgmr.checkPixelCollision(this.ball,this.leftButton,0);var A=ndgmr.checkPixelCollision(this.ball,this.rightButton,0);if(B&&this.collisionFlag!=="left"){var z=this.leftButtonPosition[0].x-this.leftButtonPosition[this.leftButtonPosition.length-1].x;var r=this.leftButtonPosition[0].y-this.leftButtonPosition[this.leftButtonPosition.length-1].y;var t=a(z,r,this.ball.vx,this.ball.vy);this.ball_music=f.Sound.play("ball_sound",{loop:0});this.collisionFlag="left";this.ball.vx=t.vx/80;this.ball.vy=t.vy/80;var u=Math.sqrt(this.ball.vx*this.ball.vx+this.ball.vy*this.ball.vy);if(u<g){this.ball.vx=g*this.ball.vx/u;this.ball.vy=g*this.ball.vx/u
}this.ball.isMoving=true;this.count=0;m=n=1}if(A&&this.collisionFlag!=="right"){var q=this.rightButtonPosition[0].x-this.rightButtonPosition[this.rightButtonPosition.length-1].x;var v=this.rightButtonPosition[0].y-this.rightButtonPosition[this.rightButtonPosition.length-1].y;var t=j(q,v,this.ball.vx,this.ball.vy);this.ball_music=f.Sound.play("ball_sound",{loop:0});this.collisionFlag="right";this.ball.vx=t.vx/80;this.ball.vy=t.vy/80;var u=Math.sqrt(this.ball.vx*this.ball.vx+this.ball.vy*this.ball.vy);if(u<g){this.ball.vx=g*this.ball.vx/u;this.ball.vy=g*this.ball.vx/u}this.ball.isMoving=true;this.count=0;m=n=1}if(this.collisionFlag==="left"||this.collisionFlag==="right"){this.count++;if(this.count>=15){this.collisionFlag=false;this.count=0}}this.ball.vCom=Math.sqrt(this.ball.vx*this.ball.vx+this.ball.vy*this.ball.vy);if(this.ball.vCom>=c){this.ball.vCom=c}this.ball.vCom-=p/e;if(Math.abs(this.ball.vCom)<=p/e){this.ball.vCom=0;this.ball.isMoving=false;this.ball.vx=0;this.ball.vy=0;this.stage.update();return}var y=this.ball.vCom*this.ball.vx/Math.sqrt(this.ball.vx*this.ball.vx+this.ball.vy*this.ball.vy);var x=this.ball.vCom*this.ball.vy/Math.sqrt(this.ball.vx*this.ball.vx+this.ball.vy*this.ball.vy);this.ball.vx=y;this.ball.vy=x;if(this.ball.isMoving){this.ball.x+=this.ball.vx*1/2;this.ball.y+=this.ball.vy*1/2;if(this.ball.x<20){if(Math.abs(n*0.8)>10){n=-n*0.8}else{this.ball.vx=-this.ball.vx}}if(this.ball.x>b.width-this.ball.width-15){if(Math.abs(n*0.8)>10){n=-n*0.8}else{this.ball.vx=-this.ball.vx}}if(this.ball.y>b.height-this.ball.height-12){if(Math.abs(m*0.8)>10){m=-m*0.8}else{this.ball.vy=-this.ball.vy}}if(this.ball.y<12){if(Math.abs(m*0.8)>10){m=-m*0.8}else{this.ball.vy=-this.ball.vy}}this.stage.update()}},rePlay:function(){f.Ticker.setPaused(false);this.initStart();this.initScore();this.initEvent()},initStart:function(){this.leftButton.x=0.1*b.width;this.leftButton.y=0.5*b.height-this.leftButton.getTransformedBounds().height*0.5;this.rightButton.x=0.8*b.width;this.rightButton.y=0.5*b.height-this.rightButton.getTransformedBounds().height*0.5;this.offsetX=this.leftButton.getTransformedBounds().width*0.1;this.offsetY=this.rightButton.getTransformedBounds().height*0.25;this.leftShadow.x=0.1*b.width+this.offsetX;this.leftShadow.y=0.5*b.height-this.offsetY;this.rightShadow.x=0.8*b.width+this.offsetX;this.rightShadow.y=0.5*b.height-this.offsetY;this.ball.x=0.5*b.width-0.5*this.ball.width;this.ball.y=0.5*b.height-0.5*this.ball.height;this.ball.isMoving=false;this.ball.vx=0;this.ball.vy=0;this.leftButtonPosition.length=0;this.rightButtonPosition.length=0;n=1;m=1},removeEvent:function(){this.leftButton.removeAllEventListeners();this.rightButton.removeAllEventListeners()},initEvent:function(){this.leftButton.addEventListener("mousedown",function(s){this.lastLeftButtonStyle=this.leftButton.getTransformedBounds();var r=this.leftButton.getTransformedBounds();var t={x:s.stageX,y:s.stageY};var q=this.leftButtonShape=s.target;q.on("pressmove",function(x){q.x=x.stageX-(t.x-r.x);q.y=x.stageY-(t.y-r.y);var w=20;var y=0.5*b.width-r.width;var v=12;var u=b.height-r.height-12;if(q.x<w){q.x=w}if(q.x>y){q.x=y}if(q.y<v){q.y=v}if(q.y>u){q.y=u}this.leftShadow.x=q.x+10;this.leftShadow.y=q.y+this.offsetY;this.stage.update()}.bind(this));q.on("pressup",function(u){}.bind(this))}.bind(this));this.rightButton.addEventListener("mousedown",function(s){var r=this.rightButton.getTransformedBounds();var t={x:s.stageX,y:s.stageY};var q=this.rightButtonShape=s.target;q.on("pressmove",function(x){q.x=x.stageX-(t.x-r.x);q.y=x.stageY-(t.y-r.y);var w=0.5*b.width;var y=b.width-r.width-15;var v=12;var u=b.height-r.height-12;if(q.x<w){q.x=w}if(q.x>y){q.x=y}if(q.y<v){q.y=v}if(q.y>u){q.y=u}this.rightShadow.x=q.x+10;this.rightShadow.y=q.y+this.offsetY;this.stage.update()}.bind(this));q.on("pressup",function(u){}.bind(this))}.bind(this))},initStage:function(){this.stage=new f.Stage(d);f.Touch.enable(this.stage);f.Ticker.setFPS(e);f.Ticker.timingMode=f.Ticker.RAF_SYNCHED;f.Ticker.addEventListener("tick",this.tick.bind(this))},handleLoadComplete:function(){this.initStage();var q=new f.Container();var u=this.loader.getResult("court");var t=new f.Bitmap(u);t.x=t.y=0;var x=(d.width/t.getBounds().width)/1.5;var w=(d.height/(t.getBounds().height))/1.5;t.scaleX=x*1.5;t.scaleY=w*1.5;q.addChild(t);var y=new f.Container();var r=this.loader.getResult("button");var s=this.loader.getResult("shadow");this.leftButton=new f.Bitmap(r);this.rightButton=new f.Bitmap(r);this.leftShadow=new f.Bitmap(s);this.rightShadow=new f.Bitmap(s);this.rightShadow.scaleX=this.leftShadow.scaleX=this.rightButton.scaleX=this.leftButton.scaleX=x;this.rightShadow.scaleY=this.leftShadow.scaleY=this.rightButton.scaleY=this.leftButton.scaleY=w;var v=this.loader.getResult("ball");this.ball=new f.Bitmap(v);this.ball.scaleX=x;this.ball.scaleY=w;this.ball.width=this.ball.getTransformedBounds().width;this.ball.height=this.ball.getTransformedBounds().height;this.initScore();this.initStart();this.initEvent();
    y.addChild(this.ball);y.addChild(this.leftShadow);y.addChild(this.rightShadow);y.addChild(this.rightButton);y.addChild(this.leftButton);this.stage.addChild(q);this.stage.addChild(y);this.stage.addEventListener("click",function(A){var z=document.getElementById("audio");if(z!==null){if(!z.paused){z.pause()}else{z.load();z.loop=true;z.play()}}this.stage.removeAllEventListeners()}.bind(this));this.stage.update()},checkIsGetScore:function(){var q=b.height;var v=b.width;var s=q*0.32;var u=q*0.64-this.ball.height/2;var r=v*0.048;var t=v*0.92;if(this.ball.x<=r){if(this.ball.y>=s&&this.ball.y<=u){return 1}}if(this.ball.x>=t){if(this.ball.y>=s&&this.ball.y<=u){return 2}}return 0}};h.gameManager=o})(window,createjs);